{"remainingRequest":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/lockhash/web-app/src/components/buttons/animate-action.vue?vue&type=script&lang=js&","dependencies":[{"path":"/root/lockhash/web-app/src/components/buttons/animate-action.vue","mtime":1553930101451},{"path":"/root/lockhash/web-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport mojs from 'mo-js'\nimport ThumbUpOutline from '$icons/ThumbUpOutline'\nimport ThumbUp from '$icons/ThumbUp'\nimport RelationBtn from './relation-btn'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  components: { RelationBtn, ThumbUp, ThumbUpOutline },\n  props: {\n    item: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      likers: this.item.cache.likes_count,\n      animationTimeline: null\n    }\n  },\n  computed: {\n    ...mapGetters(['currentUser'])\n  },\n  methods: {\n    toggle () {\n      if (!this.currentUser.id) {\n        return this.$router.push({ name: 'auth.login' })\n      }\n      this.$http\n        .post(`relations/like`, {\n          followable_type: 'App\\\\Thread',\n          followable_id: this.item.id\n        })\n        .then(() => {\n          this.item.has_liked = !this.item.has_liked\n\n          this.item.has_liked\n            ? this.$parent.thread.cache.likes_count++\n            : this.$parent.thread.cache.likes_count--\n        })\n    },\n    repeatClapping () {\n      const clapIcon = document.getElementById('clap--icon')\n\n      this.updateNumberOfClaps()\n      this.animationTimeline.replay()\n      clapIcon.classList.add('checked')\n    },\n    updateNumberOfClaps () {\n      const clapCount = document.getElementById('clap--count')\n      const clapTotalCount = document.getElementById('clap--count-total')\n      this.likers = this.$parent.thread.cache.likes_count\n\n      if (this.item.has_liked) {\n        clapCount.innerHTML = '-1'\n        clapTotalCount.innerHTML = this.likers - 1\n        this.likers--\n      } else {\n        clapCount.innerHTML = '+1'\n        clapTotalCount.innerHTML = this.likers + 1\n        this.likers++\n      }\n    }\n  },\n  mounted () {\n    const vm = this\n    const clap = document.getElementById('clap')\n    const tlDuration = 300\n    let clapHold\n\n    const triangleBurst = new mojs.Burst({\n      parent: clap,\n      radius: { 50: 95 },\n      count: 5,\n      angle: 30,\n      children: {\n        shape: 'polygon',\n        radius: { 6: 0 },\n        scale: 1,\n        stroke: 'rgba(211,84,0 ,0.5)',\n        strokeWidth: 2,\n        angle: 210,\n        delay: 30,\n        speed: 0.2,\n        easing: mojs.easing.bezier(0.1, 1, 0.3, 1),\n        duration: tlDuration\n      }\n    })\n    const circleBurst = new mojs.Burst({\n      parent: clap,\n      radius: { 50: 75 },\n      angle: 25,\n      duration: tlDuration,\n      children: {\n        shape: 'circle',\n        fill: 'rgba(149,165,166 ,0.5)',\n        delay: 30,\n        speed: 0.2,\n        radius: { 3: 0 },\n        easing: mojs.easing.bezier(0.1, 1, 0.3, 1)\n      }\n    })\n    const countAnimation = new mojs.Html({\n      el: '#clap--count',\n      isShowStart: false,\n      isShowEnd: true,\n      y: { 0: -30 },\n      opacity: { 0: 1 },\n      duration: tlDuration\n    }).then({\n      opacity: { 1: 0 },\n      y: -80,\n      delay: tlDuration / 2\n    })\n    const countTotalAnimation = new mojs.Html({\n      el: '#clap--count-total',\n      isShowStart: false,\n      isShowEnd: true,\n      opacity: { 0: 1 },\n      delay: (3 * tlDuration) / 2,\n      duration: tlDuration,\n      y: { 0: -3 }\n    })\n    const scaleButton = new mojs.Html({\n      el: '#clap',\n      duration: tlDuration,\n      scale: { 1.3: 1 },\n      easing: mojs.easing.out\n    })\n    clap.style.transform = 'scale(1, 1)' /* Bug1 fix */\n\n    this.animationTimeline = new mojs.Timeline()\n    this.animationTimeline.add([\n      triangleBurst,\n      circleBurst,\n      countAnimation,\n      countTotalAnimation,\n      scaleButton\n    ])\n\n    clap.addEventListener('click', function () {\n      vm.repeatClapping()\n    })\n\n    clap.addEventListener('mousedown', function () {\n      clapHold = setInterval(function () {\n        vm.repeatClapping()\n      }, 400)\n    })\n\n    clap.addEventListener('mouseup', function () {\n      clearInterval(clapHold)\n    })\n  }\n}\n",{"version":3,"sources":["animate-action.vue"],"names":[],"mappings":";;;;;;;;;;;;AAYA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"animate-action.vue","sourceRoot":"src/components/buttons","sourcesContent":["<template>\n  <div id=\"clap\" class=\"text-center clap d-flex align-items-center justify-content-center\" @click=\"toggle\">\n    <span id=\"clap--icon\" class=\"clap--icon\">\n      <thumb-up-outline v-if=\"!item.has_liked\" />\n      <thumb-up v-else />\n    </span>\n    <span id=\"clap--count\" class=\"clap--count\"></span>\n    <span id=\"clap--count-total\" class=\"clap--count-total\"></span>\n  </div>\n</template>\n\n<script>\nimport mojs from 'mo-js'\nimport ThumbUpOutline from '$icons/ThumbUpOutline'\nimport ThumbUp from '$icons/ThumbUp'\nimport RelationBtn from './relation-btn'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  components: { RelationBtn, ThumbUp, ThumbUpOutline },\n  props: {\n    item: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      likers: this.item.cache.likes_count,\n      animationTimeline: null\n    }\n  },\n  computed: {\n    ...mapGetters(['currentUser'])\n  },\n  methods: {\n    toggle () {\n      if (!this.currentUser.id) {\n        return this.$router.push({ name: 'auth.login' })\n      }\n      this.$http\n        .post(`relations/like`, {\n          followable_type: 'App\\\\Thread',\n          followable_id: this.item.id\n        })\n        .then(() => {\n          this.item.has_liked = !this.item.has_liked\n\n          this.item.has_liked\n            ? this.$parent.thread.cache.likes_count++\n            : this.$parent.thread.cache.likes_count--\n        })\n    },\n    repeatClapping () {\n      const clapIcon = document.getElementById('clap--icon')\n\n      this.updateNumberOfClaps()\n      this.animationTimeline.replay()\n      clapIcon.classList.add('checked')\n    },\n    updateNumberOfClaps () {\n      const clapCount = document.getElementById('clap--count')\n      const clapTotalCount = document.getElementById('clap--count-total')\n      this.likers = this.$parent.thread.cache.likes_count\n\n      if (this.item.has_liked) {\n        clapCount.innerHTML = '-1'\n        clapTotalCount.innerHTML = this.likers - 1\n        this.likers--\n      } else {\n        clapCount.innerHTML = '+1'\n        clapTotalCount.innerHTML = this.likers + 1\n        this.likers++\n      }\n    }\n  },\n  mounted () {\n    const vm = this\n    const clap = document.getElementById('clap')\n    const tlDuration = 300\n    let clapHold\n\n    const triangleBurst = new mojs.Burst({\n      parent: clap,\n      radius: { 50: 95 },\n      count: 5,\n      angle: 30,\n      children: {\n        shape: 'polygon',\n        radius: { 6: 0 },\n        scale: 1,\n        stroke: 'rgba(211,84,0 ,0.5)',\n        strokeWidth: 2,\n        angle: 210,\n        delay: 30,\n        speed: 0.2,\n        easing: mojs.easing.bezier(0.1, 1, 0.3, 1),\n        duration: tlDuration\n      }\n    })\n    const circleBurst = new mojs.Burst({\n      parent: clap,\n      radius: { 50: 75 },\n      angle: 25,\n      duration: tlDuration,\n      children: {\n        shape: 'circle',\n        fill: 'rgba(149,165,166 ,0.5)',\n        delay: 30,\n        speed: 0.2,\n        radius: { 3: 0 },\n        easing: mojs.easing.bezier(0.1, 1, 0.3, 1)\n      }\n    })\n    const countAnimation = new mojs.Html({\n      el: '#clap--count',\n      isShowStart: false,\n      isShowEnd: true,\n      y: { 0: -30 },\n      opacity: { 0: 1 },\n      duration: tlDuration\n    }).then({\n      opacity: { 1: 0 },\n      y: -80,\n      delay: tlDuration / 2\n    })\n    const countTotalAnimation = new mojs.Html({\n      el: '#clap--count-total',\n      isShowStart: false,\n      isShowEnd: true,\n      opacity: { 0: 1 },\n      delay: (3 * tlDuration) / 2,\n      duration: tlDuration,\n      y: { 0: -3 }\n    })\n    const scaleButton = new mojs.Html({\n      el: '#clap',\n      duration: tlDuration,\n      scale: { 1.3: 1 },\n      easing: mojs.easing.out\n    })\n    clap.style.transform = 'scale(1, 1)' /* Bug1 fix */\n\n    this.animationTimeline = new mojs.Timeline()\n    this.animationTimeline.add([\n      triangleBurst,\n      circleBurst,\n      countAnimation,\n      countTotalAnimation,\n      scaleButton\n    ])\n\n    clap.addEventListener('click', function () {\n      vm.repeatClapping()\n    })\n\n    clap.addEventListener('mousedown', function () {\n      clapHold = setInterval(function () {\n        vm.repeatClapping()\n      }, 400)\n    })\n\n    clap.addEventListener('mouseup', function () {\n      clearInterval(clapHold)\n    })\n  }\n}\n</script>\n\n<style lang=\"scss\">\n/*========================\n    SASS definitions\n  =======================*/\n$btn-dimension: 60px;\n$primary-color: rgba(189, 195, 199, 1);\n$secondary-color: #0078ff;\n@mixin debug {\n  outline: 1px solid red;\n}\n\n/*========================\n      BUTTON styles\n    =======================*/\n.clap--icon {\n  color: $secondary-color;\n}\n.clap {\n  position: relative;\n  border-radius: 50%;\n  background: #fff;\n  font-size: 24px;\n  width: $btn-dimension;\n  height: $btn-dimension;\n  &:after {\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: block;\n    border-radius: 50%;\n    //border: 1px solid $primary-color;\n    width: $btn-dimension - 1px;\n    height: $btn-dimension - 1px;\n  }\n  &:hover {\n    cursor: pointer;\n    background: #fff60;\n    font-size: 26px;\n    transition: all 0.3s ease-in;\n    &:after {\n      animation: shockwave 1s ease-in infinite;\n    }\n  }\n  .clap--count {\n    position: absolute;\n    top: -$btn-dimension/1.6;\n    left: $btn-dimension/4;\n    font-size: 0.8rem;\n    color: white;\n    background: $secondary-color;\n    border-radius: 50%;\n    height: $btn-dimension/2;\n    width: $btn-dimension/2;\n    line-height: $btn-dimension/2;\n  }\n  .clap--count-total {\n    position: absolute;\n    font-size: 0.8rem;\n    width: $btn-dimension;\n    text-align: center;\n    left: 0;\n    bottom: -$btn-dimension/2.5;\n    color: $primary-color;\n  }\n}\n</style>\n"]}]}