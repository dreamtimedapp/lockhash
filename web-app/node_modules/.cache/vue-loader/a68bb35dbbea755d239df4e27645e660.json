{"remainingRequest":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/lockhash/web-app/src/modules/users/tabs/activities.vue?vue&type=script&lang=js&","dependencies":[{"path":"/root/lockhash/web-app/src/modules/users/tabs/activities.vue","mtime":1553930101455},{"path":"/root/lockhash/web-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport UserCard from '$components/user-card'\nimport ArrowDownIcon from '$icons/ArrowDown'\nimport SourceCommitEnd from '$icons/SourceCommitEnd'\nimport EmptyState from '$components/empty-state'\n\nexport default {\n  name: 'user-activities',\n  data () {\n    return {\n      activities: {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      }\n    }\n  },\n  components: { UserCard, ArrowDownIcon, SourceCommitEnd, EmptyState },\n  beforeRouteUpdate (to, from, next) {\n    if (to.params.username != from.params.username) {\n      this.activities = {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      }\n      this.loadActivities(to.params.username)\n    }\n\n    next()\n  },\n  methods: {\n    subjectLink (activity) {\n      switch (activity.subject_type) {\n      case 'App\\\\Thread':\n        if (activity.log_name == 'commented.thread') {\n          return {\n            name: 'threads.show',\n            params: { id: activity.subject.id },\n            hash: '#comment-' + activity.properties.comment_id || 0\n          }\n        }\n        return { name: 'threads.show', params: { id: activity.subject.id } }\n      case 'App\\\\Comment':\n        return { name: 'threads.show', params: { id: activity.subject.id } }\n      case 'App\\\\User':\n        return {\n          name: 'users.show',\n          params: { id: activity.subject.username }\n        }\n      }\n      return {}\n    },\n    loadActivities (username) {\n      let page = this.activities.meta.current_page + 1\n      this.$http\n        .get(`user/${username}/activities?per_page=10&page=${page}`)\n        .then(activities => {\n          this.activities.data = this.activities.data.concat(activities.data)\n          this.activities.meta = activities.meta\n        })\n    }\n  },\n  mounted () {\n    this.loadActivities(this.$parent.user.username)\n  }\n}\n",{"version":3,"sources":["activities.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"activities.vue","sourceRoot":"src/modules/users/tabs","sourcesContent":["<template>\n  <div class=\"user-activities\">\n    <div v-if=\"activities.data.length <= 0\">\n      <empty-state />\n    </div>\n    <ul class=\"timeline pb-2\" v-else>\n      <li class=\"timeline-item\" v-for=\"activity in activities.data\" :key=\"activity.id\" v-if=\"activity.subject\">\n        <div class=\"timeline-heading\">\n          <div class=\"d-flex\">\n            <router-link :to=\"{name:'users.show', params: {username: $parent.user.username}}\">\n              <img :src=\"$parent.user.avatar\" class=\"avatar-40\" :alt=\"$parent.user.name\" />\n            </router-link>\n            <div class=\"ml-2\">\n              <div>\n                <router-link :to=\"{name:'users.show', params: {username: $parent.user.username}}\">\n                  <h6 class=\"mb-0 text-16 d-inline-block\">{{ $parent.user.name }}</h6>\n                </router-link>\n                <span class=\"text-gray-60 ml-1\">\n                  <template v-if=\"activity.log_name == 'commented.thread'\">\n                    评论了 <router-link :to=\"subjectLink(activity)\">《{{ activity.subject.title }}》</router-link>\n                  </template>\n                  <template v-else-if=\"activity.log_name == 'published.thread'\">\n                    发布了 <router-link :to=\"subjectLink(activity)\">《{{ activity.subject.title }}》</router-link>\n                  </template>\n                  <template v-else-if=\"activity.log_name == 'like.thread'\">\n                    赞了 <router-link :to=\"subjectLink(activity)\">《{{ activity.subject.title }}》</router-link>\n                  </template>\n                  <template v-else-if=\"activity.log_name == 'follow.user'\">\n                    关注了 <router-link :to=\"subjectLink(activity)\">{{ activity.subject.username }}</router-link>\n                  </template>\n                </span>\n              </div>\n              <div class=\"text-12 text-gray-70\"><small class=\"text-muted\">{{ activity.created_at_timeago }}</small></div>\n            </div>\n          </div>\n        </div>\n        <div class=\"timeline-body\">\n          <user-card :user=\"activity.subject\" v-if=\"activity.log_name == 'follow.user'\"></user-card>\n          <div class=\"box cursor-pointer\" v-else>\n            <router-link class=\"text-muted\" :to=\"subjectLink(activity)\">{{ activity.properties['content'] || '无' }}</router-link>\n          </div>\n        </div>\n      </li>\n      <li class=\"timeline-item\" v-if=\"activities.meta.current_page < activities.meta.last_page\">\n        <div class=\"timeline-heading\">\n          <div class=\"d-flex\">\n            <button class=\"btn btn-secondary btn-icon text-20\" @click=\"loadActivities($parent.user.username)\">\n              <arrow-down-icon /></button>\n          </div>\n        </div>\n      </li>\n      <li class=\"timeline-item\" v-if=\"activities.meta.current_page == activities.meta.last_page\">\n        <div class=\"timeline-heading\">\n          <div class=\"d-flex\">\n            <button class=\"btn btn-secondary btn-icon text-20\" disabled>\n              <source-commit-end /></button>\n          </div>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport UserCard from '$components/user-card'\nimport ArrowDownIcon from '$icons/ArrowDown'\nimport SourceCommitEnd from '$icons/SourceCommitEnd'\nimport EmptyState from '$components/empty-state'\n\nexport default {\n  name: 'user-activities',\n  data () {\n    return {\n      activities: {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      }\n    }\n  },\n  components: { UserCard, ArrowDownIcon, SourceCommitEnd, EmptyState },\n  beforeRouteUpdate (to, from, next) {\n    if (to.params.username != from.params.username) {\n      this.activities = {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      }\n      this.loadActivities(to.params.username)\n    }\n\n    next()\n  },\n  methods: {\n    subjectLink (activity) {\n      switch (activity.subject_type) {\n      case 'App\\\\Thread':\n        if (activity.log_name == 'commented.thread') {\n          return {\n            name: 'threads.show',\n            params: { id: activity.subject.id },\n            hash: '#comment-' + activity.properties.comment_id || 0\n          }\n        }\n        return { name: 'threads.show', params: { id: activity.subject.id } }\n      case 'App\\\\Comment':\n        return { name: 'threads.show', params: { id: activity.subject.id } }\n      case 'App\\\\User':\n        return {\n          name: 'users.show',\n          params: { id: activity.subject.username }\n        }\n      }\n      return {}\n    },\n    loadActivities (username) {\n      let page = this.activities.meta.current_page + 1\n      this.$http\n        .get(`user/${username}/activities?per_page=10&page=${page}`)\n        .then(activities => {\n          this.activities.data = this.activities.data.concat(activities.data)\n          this.activities.meta = activities.meta\n        })\n    }\n  },\n  mounted () {\n    this.loadActivities(this.$parent.user.username)\n  }\n}\n</script>\n"]}]}