{"remainingRequest":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/lockhash/web-app/src/components/nav-search.vue?vue&type=style&index=0&id=180a622a&scoped=true&lang=scss&","dependencies":[{"path":"/root/lockhash/web-app/src/components/nav-search.vue","mtime":1553930101455},{"path":"/root/lockhash/web-app/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.search-form {\n  position: relative;\n  .list-group {\n    position: absolute;\n    top: 100%;\n    left: 0;\n    min-width: 400px;\n    max-height: 80vh;\n    overflow-y: auto;\n    box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.1);\n    z-index: 99;\n  }\n}\n",{"version":3,"sources":["nav-search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"nav-search.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <form class=\"search-form form-inline my-2 my-lg-0\">\n    <input class=\"form-control mr-sm-2\" type=\"search\" v-model=\"q\" placeholder=\"搜索讨论\" aria-label=\"Search\">\n    <div class=\"list-group\" v-if=\"threads.length > 0\">\n      <div class=\"list-group-item list-group-item-action cursor-pointer\" v-for=\"item of threads\" :key=\"item.id\" @click=\"$router.push({name: 'threads.show', params:{id: item.id}})\">\n        <div class=\"d-flex align-items-center\">\n          <a href=\"#\" class=\"mr-2\"><img :src=\"item.user.avatar\" alt=\"\" class=\"avatar-30\"></a>\n          <div class=\"highlights text-gray-50 text-truncate\" v-html=\"item['highlights'] && item['highlights']['title'] ? item.highlights.title[0] : item.title\"></div>\n        </div>\n        <p class=\"highlights mt-1 text-gray-60\" v-if=\"item.highlights['content']\" v-html=\"highlightContent(item)\"></p>\n      </div>\n    </div>\n  </form>\n</template>\n\n<script>\nexport default {\n  name: 'nav-search',\n  data () {\n    return {\n      q: '',\n      threads: []\n    }\n  },\n  watch: {\n    q () {\n      if (this.q.length > 0) {\n        this.search()\n      } else {\n        this.threads = []\n      }\n    }\n  },\n  mounted () {\n    this.$nextTick(() => {\n      document.addEventListener('click', this.onBodyClick)\n    })\n  },\n  beforeDestroy () {\n    document.removeEventListener('click', this.onBodyClick)\n  },\n  methods: {\n    onBodyClick (e) {\n      let searchForm = document.querySelector('.search-form')\n      if (e.target !== searchForm) {\n        this.threads = []\n      }\n    },\n    highlightContent (item) {\n      return (item.highlights['content'] || []).join('...')\n    },\n    search () {\n      this.$http.get(`/threads/search?q=` + this.q).then(response => {\n        this.threads = response.data\n      })\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.search-form {\n  position: relative;\n  .list-group {\n    position: absolute;\n    top: 100%;\n    left: 0;\n    min-width: 400px;\n    max-height: 80vh;\n    overflow-y: auto;\n    box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.1);\n    z-index: 99;\n  }\n}\n</style>\n"]}]}