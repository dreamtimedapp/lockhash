{"remainingRequest":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/lockhash/web-app/src/components/editor/src/Editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/root/lockhash/web-app/src/components/editor/src/Editor.vue","mtime":1553930101455},{"path":"/root/lockhash/web-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport CodeMirror from 'codemirror'\nimport EmojiCompleter from '../emoji-completer'\nimport AtCompleter from '../at-completer'\nimport '../attachment'\nimport { mapGetters } from 'vuex'\nimport PlusIcon from '$icons/Plus'\nimport LinkIcon from '$icons/Link'\nimport FormatHeader1Icon from '$icons/FormatHeader1'\nimport FormatHeader2Icon from '$icons/FormatHeader2'\nimport FormatHeader3Icon from '$icons/FormatHeader3'\nimport FormatBoldIcon from '$icons/FormatBold'\nimport FormatItalicIcon from '$icons/FormatItalic'\nimport FormatQuoteOpenIcon from '$icons/FormatQuoteOpen'\nimport CodeTagsIcon from '$icons/CodeTags'\nimport FormatListBulletedIcon from '$icons/FormatListBulleted'\nimport FormatListNumbersIcon from '$icons/FormatListNumbered'\nimport MarkdownBody from '$components/markdown-body'\n\nrequire('codemirror/mode/gfm/gfm')\nrequire('codemirror/addon/edit/continuelist')\nrequire('codemirror/addon/edit/matchbrackets')\nrequire('codemirror/addon/edit/closebrackets')\nrequire('codemirror/addon/edit/matchtags')\nrequire('codemirror/addon/display/placeholder')\nrequire('codemirror/keymap/sublime')\nrequire('../theme/yike.css')\n\nexport default {\n  name: 'editor',\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    toolbar: {\n      type: Boolean,\n      default: false\n    },\n    editorClass: {\n      type: String,\n      default: 'p-2'\n    },\n    placeholder: {\n      type: String,\n      default: '请在这里输入你的内容'\n    },\n    options: {\n      type: Object,\n      default () {\n        return {}\n      }\n    }\n  },\n  components: {\n    MarkdownBody,\n    PlusIcon,\n    FormatHeader1Icon,\n    FormatHeader2Icon,\n    FormatHeader3Icon,\n    FormatBoldIcon,\n    FormatItalicIcon,\n    FormatQuoteOpenIcon,\n    FormatListNumbersIcon,\n    FormatListBulletedIcon,\n    CodeTagsIcon,\n    LinkIcon\n  },\n  data () {\n    return {\n      contentBackup: false,\n      editor: null,\n      editSession: null,\n      selection: null,\n      undoManager: null,\n      tribute: null,\n      html: '预览生成中...'\n    }\n  },\n  watch: {\n    value () {\n      if (this.contentBackup === this.value) {\n        return\n      }\n      this.setValue()\n    }\n  },\n  computed: {\n    ...mapGetters(['authToken'])\n  },\n  methods: {\n    init () {\n      this.initEditor()\n    },\n\n    initEditor () {\n      this.editor = CodeMirror.fromTextArea(document.getElementById('editor'), {\n        keyMap: 'sublime',\n        mode: 'markdown',\n        lineWrapping: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        matchBothTags: true,\n        value: this.value || '',\n        profile: 'html',\n        extraKeys: { Enter: 'newlineAndIndentContinueMarkdownList' }\n      })\n      this.editor.on('change', EmojiCompleter)\n      this.editor.on('change', AtCompleter)\n      this.editor.on('change', editor => {\n        let content = editor.getValue()\n        this.$emit('input', content)\n        this.contentBackup = content\n      })\n      window.inlineAttachment.editors.codemirror4.attach(this.editor, {\n        uploadFieldName: 'file',\n        jsonFieldName: 'url',\n        uploadUrl: this.$http.defaults.baseURL + '/files/upload',\n        extraHeaders: {\n          Authorization: `Bearer ${this.authToken}`\n        }\n      })\n    },\n\n    setValue () {\n      if (this.value) {\n        this.editor.setValue(this.value, 1)\n      }\n    },\n    preview () {\n      if (this.value.length <= 0) {\n        return (this.html = '请先输入内容')\n      }\n      this.html = '预览生成中...'\n      this.$http\n        .post('contents/preview', { markdown: this.value })\n        .then(html => (this.html = html))\n    }\n  },\n  mounted () {\n    this.init()\n    this.setValue()\n  }\n}\n",{"version":3,"sources":["Editor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Editor.vue","sourceRoot":"src/components/editor/src","sourcesContent":["<template>\n  <div class=\"editor\">\n    <div class=\"card-header\">\n      <ul class=\"nav nav-tabs card-header-tabs\" role=\"tablist\">\n        <li class=\"nav-item\">\n          <a\n            class=\"nav-link active\"\n            data-toggle=\"tab\"\n            href=\"#form-tab-editor\"\n            role=\"tab\"\n            aria-controls=\"form-tab-editor\"\n            aria-selected=\"true\"\n          >编辑</a>\n        </li>\n        <li class=\"nav-item\">\n          <a\n            class=\"nav-link\"\n            @click=\"preview\"\n            data-toggle=\"tab\"\n            href=\"#form-tab-preview\"\n            role=\"tab\"\n            aria-controls=\"form-tab-editor\"\n            aria-selected=\"false\"\n          >预览</a>\n        </li>\n        <li class=\"nav-item ml-auto\">\n          <div v-if=\"toolbar\" class=\"editor-toolbar border-bottom d-flex align-items-center px-2\">\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleHeading(2)\"><format-header2-icon></format-header2-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleHeading(3)\"><format-header3-icon></format-header3-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleBold\"><format-bold-icon></format-bold-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleItalic\"><format-italic-icon></format-italic-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleBlockquote\"><format-quote-open-icon></format-quote-open-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"insertCode\"><code-tags-icon></code-tags-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleUnorderedList\"><format-list-bulleted-icon></format-list-bulleted-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleOrderedList\"><format-list-numbers-icon></format-list-numbers-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"insertLink\"><link-icon></link-icon></button>-->\n          </div>\n        </li>\n      </ul>\n    </div>\n    <div class=\"tab-content card-body\" id=\"form-tab-content\">\n      <div class=\"tab-pane fade show active\" id=\"form-tab-editor\" style=\"margin-left: -0.35rem;\">\n        <textarea id=\"editor\" :placeholder=\"placeholder\"></textarea>\n      </div>\n      <div class=\"tab-pane fade\" id=\"form-tab-preview\" style=\"min-height: 100%;\">\n        <markdown-body v-model=\"html\"></markdown-body>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport CodeMirror from 'codemirror'\nimport EmojiCompleter from '../emoji-completer'\nimport AtCompleter from '../at-completer'\nimport '../attachment'\nimport { mapGetters } from 'vuex'\nimport PlusIcon from '$icons/Plus'\nimport LinkIcon from '$icons/Link'\nimport FormatHeader1Icon from '$icons/FormatHeader1'\nimport FormatHeader2Icon from '$icons/FormatHeader2'\nimport FormatHeader3Icon from '$icons/FormatHeader3'\nimport FormatBoldIcon from '$icons/FormatBold'\nimport FormatItalicIcon from '$icons/FormatItalic'\nimport FormatQuoteOpenIcon from '$icons/FormatQuoteOpen'\nimport CodeTagsIcon from '$icons/CodeTags'\nimport FormatListBulletedIcon from '$icons/FormatListBulleted'\nimport FormatListNumbersIcon from '$icons/FormatListNumbered'\nimport MarkdownBody from '$components/markdown-body'\n\nrequire('codemirror/mode/gfm/gfm')\nrequire('codemirror/addon/edit/continuelist')\nrequire('codemirror/addon/edit/matchbrackets')\nrequire('codemirror/addon/edit/closebrackets')\nrequire('codemirror/addon/edit/matchtags')\nrequire('codemirror/addon/display/placeholder')\nrequire('codemirror/keymap/sublime')\nrequire('../theme/yike.css')\n\nexport default {\n  name: 'editor',\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    toolbar: {\n      type: Boolean,\n      default: false\n    },\n    editorClass: {\n      type: String,\n      default: 'p-2'\n    },\n    placeholder: {\n      type: String,\n      default: '请在这里输入你的内容'\n    },\n    options: {\n      type: Object,\n      default () {\n        return {}\n      }\n    }\n  },\n  components: {\n    MarkdownBody,\n    PlusIcon,\n    FormatHeader1Icon,\n    FormatHeader2Icon,\n    FormatHeader3Icon,\n    FormatBoldIcon,\n    FormatItalicIcon,\n    FormatQuoteOpenIcon,\n    FormatListNumbersIcon,\n    FormatListBulletedIcon,\n    CodeTagsIcon,\n    LinkIcon\n  },\n  data () {\n    return {\n      contentBackup: false,\n      editor: null,\n      editSession: null,\n      selection: null,\n      undoManager: null,\n      tribute: null,\n      html: '预览生成中...'\n    }\n  },\n  watch: {\n    value () {\n      if (this.contentBackup === this.value) {\n        return\n      }\n      this.setValue()\n    }\n  },\n  computed: {\n    ...mapGetters(['authToken'])\n  },\n  methods: {\n    init () {\n      this.initEditor()\n    },\n\n    initEditor () {\n      this.editor = CodeMirror.fromTextArea(document.getElementById('editor'), {\n        keyMap: 'sublime',\n        mode: 'markdown',\n        lineWrapping: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        matchBothTags: true,\n        value: this.value || '',\n        profile: 'html',\n        extraKeys: { Enter: 'newlineAndIndentContinueMarkdownList' }\n      })\n      this.editor.on('change', EmojiCompleter)\n      this.editor.on('change', AtCompleter)\n      this.editor.on('change', editor => {\n        let content = editor.getValue()\n        this.$emit('input', content)\n        this.contentBackup = content\n      })\n      window.inlineAttachment.editors.codemirror4.attach(this.editor, {\n        uploadFieldName: 'file',\n        jsonFieldName: 'url',\n        uploadUrl: this.$http.defaults.baseURL + '/files/upload',\n        extraHeaders: {\n          Authorization: `Bearer ${this.authToken}`\n        }\n      })\n    },\n\n    setValue () {\n      if (this.value) {\n        this.editor.setValue(this.value, 1)\n      }\n    },\n    preview () {\n      if (this.value.length <= 0) {\n        return (this.html = '请先输入内容')\n      }\n      this.html = '预览生成中...'\n      this.$http\n        .post('contents/preview', { markdown: this.value })\n        .then(html => (this.html = html))\n    }\n  },\n  mounted () {\n    this.init()\n    this.setValue()\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.ace_gutter {\n  -webkit-font-smoothing: antialiased;\n}\n</style>\n"]}]}