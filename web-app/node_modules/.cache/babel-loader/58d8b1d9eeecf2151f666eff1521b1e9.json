{"remainingRequest":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js!/root/lockhash/web-app/node_modules/babel-loader/lib/index.js!/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/root/lockhash/web-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/lockhash/web-app/src/components/editor/src/Editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/root/lockhash/web-app/src/components/editor/src/Editor.vue","mtime":1553930101455},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/root/lockhash/web-app/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport CodeMirror from 'codemirror';\nimport EmojiCompleter from '../emoji-completer';\nimport AtCompleter from '../at-completer';\nimport '../attachment';\nimport { mapGetters } from 'vuex';\nimport PlusIcon from '$icons/Plus';\nimport LinkIcon from '$icons/Link';\nimport FormatHeader1Icon from '$icons/FormatHeader1';\nimport FormatHeader2Icon from '$icons/FormatHeader2';\nimport FormatHeader3Icon from '$icons/FormatHeader3';\nimport FormatBoldIcon from '$icons/FormatBold';\nimport FormatItalicIcon from '$icons/FormatItalic';\nimport FormatQuoteOpenIcon from '$icons/FormatQuoteOpen';\nimport CodeTagsIcon from '$icons/CodeTags';\nimport FormatListBulletedIcon from '$icons/FormatListBulleted';\nimport FormatListNumbersIcon from '$icons/FormatListNumbered';\nimport MarkdownBody from '$components/markdown-body';\n\nrequire('codemirror/mode/gfm/gfm');\n\nrequire('codemirror/addon/edit/continuelist');\n\nrequire('codemirror/addon/edit/matchbrackets');\n\nrequire('codemirror/addon/edit/closebrackets');\n\nrequire('codemirror/addon/edit/matchtags');\n\nrequire('codemirror/addon/display/placeholder');\n\nrequire('codemirror/keymap/sublime');\n\nrequire('../theme/yike.css');\n\nexport default {\n  name: 'editor',\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    toolbar: {\n      type: Boolean,\n      default: false\n    },\n    editorClass: {\n      type: String,\n      default: 'p-2'\n    },\n    placeholder: {\n      type: String,\n      default: '请在这里输入你的内容'\n    },\n    options: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  components: {\n    MarkdownBody: MarkdownBody,\n    PlusIcon: PlusIcon,\n    FormatHeader1Icon: FormatHeader1Icon,\n    FormatHeader2Icon: FormatHeader2Icon,\n    FormatHeader3Icon: FormatHeader3Icon,\n    FormatBoldIcon: FormatBoldIcon,\n    FormatItalicIcon: FormatItalicIcon,\n    FormatQuoteOpenIcon: FormatQuoteOpenIcon,\n    FormatListNumbersIcon: FormatListNumbersIcon,\n    FormatListBulletedIcon: FormatListBulletedIcon,\n    CodeTagsIcon: CodeTagsIcon,\n    LinkIcon: LinkIcon\n  },\n  data: function data() {\n    return {\n      contentBackup: false,\n      editor: null,\n      editSession: null,\n      selection: null,\n      undoManager: null,\n      tribute: null,\n      html: '预览生成中...'\n    };\n  },\n  watch: {\n    value: function value() {\n      if (this.contentBackup === this.value) {\n        return;\n      }\n\n      this.setValue();\n    }\n  },\n  computed: _objectSpread({}, mapGetters(['authToken'])),\n  methods: {\n    init: function init() {\n      this.initEditor();\n    },\n    initEditor: function initEditor() {\n      var _this = this;\n\n      this.editor = CodeMirror.fromTextArea(document.getElementById('editor'), {\n        keyMap: 'sublime',\n        mode: 'markdown',\n        lineWrapping: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        matchBothTags: true,\n        value: this.value || '',\n        profile: 'html',\n        extraKeys: {\n          Enter: 'newlineAndIndentContinueMarkdownList'\n        }\n      });\n      this.editor.on('change', EmojiCompleter);\n      this.editor.on('change', AtCompleter);\n      this.editor.on('change', function (editor) {\n        var content = editor.getValue();\n\n        _this.$emit('input', content);\n\n        _this.contentBackup = content;\n      });\n      window.inlineAttachment.editors.codemirror4.attach(this.editor, {\n        uploadFieldName: 'file',\n        jsonFieldName: 'url',\n        uploadUrl: this.$http.defaults.baseURL + '/files/upload',\n        extraHeaders: {\n          Authorization: \"Bearer \".concat(this.authToken)\n        }\n      });\n    },\n    setValue: function setValue() {\n      if (this.value) {\n        this.editor.setValue(this.value, 1);\n      }\n    },\n    preview: function preview() {\n      var _this2 = this;\n\n      if (this.value.length <= 0) {\n        return this.html = '请先输入内容';\n      }\n\n      this.html = '预览生成中...';\n      this.$http.post('contents/preview', {\n        markdown: this.value\n      }).then(function (html) {\n        return _this2.html = html;\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n    this.setValue();\n  }\n};",{"version":3,"sources":["Editor.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"editor\">\n    <div class=\"card-header\">\n      <ul class=\"nav nav-tabs card-header-tabs\" role=\"tablist\">\n        <li class=\"nav-item\">\n          <a\n            class=\"nav-link active\"\n            data-toggle=\"tab\"\n            href=\"#form-tab-editor\"\n            role=\"tab\"\n            aria-controls=\"form-tab-editor\"\n            aria-selected=\"true\"\n          >编辑</a>\n        </li>\n        <li class=\"nav-item\">\n          <a\n            class=\"nav-link\"\n            @click=\"preview\"\n            data-toggle=\"tab\"\n            href=\"#form-tab-preview\"\n            role=\"tab\"\n            aria-controls=\"form-tab-editor\"\n            aria-selected=\"false\"\n          >预览</a>\n        </li>\n        <li class=\"nav-item ml-auto\">\n          <div v-if=\"toolbar\" class=\"editor-toolbar border-bottom d-flex align-items-center px-2\">\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleHeading(2)\"><format-header2-icon></format-header2-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleHeading(3)\"><format-header3-icon></format-header3-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleBold\"><format-bold-icon></format-bold-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleItalic\"><format-italic-icon></format-italic-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleBlockquote\"><format-quote-open-icon></format-quote-open-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"insertCode\"><code-tags-icon></code-tags-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleUnorderedList\"><format-list-bulleted-icon></format-list-bulleted-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"toggleOrderedList\"><format-list-numbers-icon></format-list-numbers-icon></button>-->\n            <!--<button class=\"btn btn-link p-1 text-18 text-grey-blue\" type=\"button\" @click=\"insertLink\"><link-icon></link-icon></button>-->\n          </div>\n        </li>\n      </ul>\n    </div>\n    <div class=\"tab-content card-body\" id=\"form-tab-content\">\n      <div class=\"tab-pane fade show active\" id=\"form-tab-editor\" style=\"margin-left: -0.35rem;\">\n        <textarea id=\"editor\" :placeholder=\"placeholder\"></textarea>\n      </div>\n      <div class=\"tab-pane fade\" id=\"form-tab-preview\" style=\"min-height: 100%;\">\n        <markdown-body v-model=\"html\"></markdown-body>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport CodeMirror from 'codemirror'\nimport EmojiCompleter from '../emoji-completer'\nimport AtCompleter from '../at-completer'\nimport '../attachment'\nimport { mapGetters } from 'vuex'\nimport PlusIcon from '$icons/Plus'\nimport LinkIcon from '$icons/Link'\nimport FormatHeader1Icon from '$icons/FormatHeader1'\nimport FormatHeader2Icon from '$icons/FormatHeader2'\nimport FormatHeader3Icon from '$icons/FormatHeader3'\nimport FormatBoldIcon from '$icons/FormatBold'\nimport FormatItalicIcon from '$icons/FormatItalic'\nimport FormatQuoteOpenIcon from '$icons/FormatQuoteOpen'\nimport CodeTagsIcon from '$icons/CodeTags'\nimport FormatListBulletedIcon from '$icons/FormatListBulleted'\nimport FormatListNumbersIcon from '$icons/FormatListNumbered'\nimport MarkdownBody from '$components/markdown-body'\n\nrequire('codemirror/mode/gfm/gfm')\nrequire('codemirror/addon/edit/continuelist')\nrequire('codemirror/addon/edit/matchbrackets')\nrequire('codemirror/addon/edit/closebrackets')\nrequire('codemirror/addon/edit/matchtags')\nrequire('codemirror/addon/display/placeholder')\nrequire('codemirror/keymap/sublime')\nrequire('../theme/yike.css')\n\nexport default {\n  name: 'editor',\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    toolbar: {\n      type: Boolean,\n      default: false\n    },\n    editorClass: {\n      type: String,\n      default: 'p-2'\n    },\n    placeholder: {\n      type: String,\n      default: '请在这里输入你的内容'\n    },\n    options: {\n      type: Object,\n      default () {\n        return {}\n      }\n    }\n  },\n  components: {\n    MarkdownBody,\n    PlusIcon,\n    FormatHeader1Icon,\n    FormatHeader2Icon,\n    FormatHeader3Icon,\n    FormatBoldIcon,\n    FormatItalicIcon,\n    FormatQuoteOpenIcon,\n    FormatListNumbersIcon,\n    FormatListBulletedIcon,\n    CodeTagsIcon,\n    LinkIcon\n  },\n  data () {\n    return {\n      contentBackup: false,\n      editor: null,\n      editSession: null,\n      selection: null,\n      undoManager: null,\n      tribute: null,\n      html: '预览生成中...'\n    }\n  },\n  watch: {\n    value () {\n      if (this.contentBackup === this.value) {\n        return\n      }\n      this.setValue()\n    }\n  },\n  computed: {\n    ...mapGetters(['authToken'])\n  },\n  methods: {\n    init () {\n      this.initEditor()\n    },\n\n    initEditor () {\n      this.editor = CodeMirror.fromTextArea(document.getElementById('editor'), {\n        keyMap: 'sublime',\n        mode: 'markdown',\n        lineWrapping: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        matchBothTags: true,\n        value: this.value || '',\n        profile: 'html',\n        extraKeys: { Enter: 'newlineAndIndentContinueMarkdownList' }\n      })\n      this.editor.on('change', EmojiCompleter)\n      this.editor.on('change', AtCompleter)\n      this.editor.on('change', editor => {\n        let content = editor.getValue()\n        this.$emit('input', content)\n        this.contentBackup = content\n      })\n      window.inlineAttachment.editors.codemirror4.attach(this.editor, {\n        uploadFieldName: 'file',\n        jsonFieldName: 'url',\n        uploadUrl: this.$http.defaults.baseURL + '/files/upload',\n        extraHeaders: {\n          Authorization: `Bearer ${this.authToken}`\n        }\n      })\n    },\n\n    setValue () {\n      if (this.value) {\n        this.editor.setValue(this.value, 1)\n      }\n    },\n    preview () {\n      if (this.value.length <= 0) {\n        return (this.html = '请先输入内容')\n      }\n      this.html = '预览生成中...'\n      this.$http\n        .post('contents/preview', { markdown: this.value })\n        .then(html => (this.html = html))\n    }\n  },\n  mounted () {\n    this.init()\n    this.setValue()\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.ace_gutter {\n  -webkit-font-smoothing: antialiased;\n}\n</style>\n"],"sourceRoot":"src/components/editor/src"}]}