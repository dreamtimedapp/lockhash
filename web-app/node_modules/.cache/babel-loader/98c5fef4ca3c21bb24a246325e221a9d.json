{"remainingRequest":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js!/root/lockhash/web-app/node_modules/babel-loader/lib/index.js!/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/root/lockhash/web-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/lockhash/web-app/src/modules/users/profile/avatar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/root/lockhash/web-app/src/modules/users/profile/avatar.vue","mtime":1553930101455},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/root/lockhash/web-app/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/root/lockhash/web-app/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport AvatarCropper from 'vue-avatar-cropper';\nimport { mapGetters } from 'vuex';\nexport default {\n  components: {\n    AvatarCropper: AvatarCropper\n  },\n  data: function data() {\n    return {\n      url: this.$parent.currentUser.avatar,\n      newUrl: null\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['authToken']), {\n    uploadUrl: function uploadUrl() {\n      return this.$http.defaults.baseURL + '/files/upload';\n    },\n    uploadHeaders: function uploadHeaders() {\n      return {\n        Authorization: \"Bearer \".concat(this.authToken)\n      };\n    }\n  }),\n  methods: {\n    handleUploaded: function handleUploaded(response) {\n      if (!response.success) {\n        this.$message.error(response.error);\n      }\n\n      this.url = this.newUrl = response.url;\n    },\n    submit: function () {\n      var _submit = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.$http.patch(\"users/\".concat(this.$parent.currentUser.username), {\n                  avatar: this.newUrl\n                }).then(function () {\n                  _this.$message.success('头像已更新');\n\n                  _this.$store.dispatch('loadUser');\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function submit() {\n        return _submit.apply(this, arguments);\n      }\n\n      return submit;\n    }()\n  }\n};",{"version":3,"sources":["avatar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAkBA,OAAA,aAAA,MAAA,oBAAA;AACA,SAAA,UAAA,QAAA,MAAA;AAEA,eAAA;AACA,EAAA,UAAA,EAAA;AAAA,IAAA,aAAA,EAAA;AAAA,GADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,GAAA,EAAA,KAAA,OAAA,CAAA,WAAA,CAAA,MADA;AAEA,MAAA,MAAA,EAAA;AAFA,KAAA;AAIA,GAPA;AAQA,EAAA,QAAA,oBACA,UAAA,CAAA,CAAA,WAAA,CAAA,CADA;AAEA,IAAA,SAFA,uBAEA;AACA,aAAA,KAAA,KAAA,CAAA,QAAA,CAAA,OAAA,GAAA,eAAA;AACA,KAJA;AAKA,IAAA,aALA,2BAKA;AACA,aAAA;AACA,QAAA,aAAA,mBAAA,KAAA,SAAA;AADA,OAAA;AAGA;AATA,IARA;AAmBA,EAAA,OAAA,EAAA;AACA,IAAA,cADA,0BACA,QADA,EACA;AACA,UAAA,CAAA,QAAA,CAAA,OAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,QAAA,CAAA,KAAA;AACA;;AAEA,WAAA,GAAA,GAAA,KAAA,MAAA,GAAA,QAAA,CAAA,GAAA;AACA,KAPA;AAQA,IAAA,MARA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBASA,KAAA,KAAA,CACA,KADA,iBACA,KAAA,OAAA,CAAA,WAAA,CAAA,QADA,GACA;AACA,kBAAA,MAAA,EAAA,KAAA;AADA,iBADA,EAIA,IAJA,CAIA,YAAA;AACA,kBAAA,KAAA,CAAA,QAAA,CAAA,OAAA,CAAA,OAAA;;AACA,kBAAA,KAAA,CAAA,MAAA,CAAA,QAAA,CAAA,UAAA;AACA,iBAPA,CATA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAnBA,CAAA","sourcesContent":["<template>\n  <div class=\"box\">\n    <div class=\"box-heading border-bottom\">\n      <h5>修改头像</h5>\n    </div>\n    <img :src=\"url\" class=\"rounded-circle shadow-6 avatar-120\" alt=\"user avatar\">\n    <img :src=\"url\" class=\"rounded-circle shadow-6 ml-2 avatar-60\" alt=\"user avatar\">\n    <img :src=\"url\" class=\"rounded-circle shadow-6 ml-2 avatar-30\" alt=\"user avatar\">\n\n    <button class=\"btn btn-light d-block mt-2\" id=\"pick-avatar\">选择新头像</button>\n\n    <avatar-cropper @uploaded=\"handleUploaded\" trigger=\"#pick-avatar\" :upload-url=\"uploadUrl\" :upload-headers=\"uploadHeaders\" />\n\n    <button class=\"btn btn-primary mt-2\" @click=\"submit\" :disabled=\"!newUrl\">保存</button>\n  </div>\n</template>\n\n<script>\nimport AvatarCropper from 'vue-avatar-cropper'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  components: { AvatarCropper },\n  data () {\n    return {\n      url: this.$parent.currentUser.avatar,\n      newUrl: null\n    }\n  },\n  computed: {\n    ...mapGetters(['authToken']),\n    uploadUrl () {\n      return this.$http.defaults.baseURL + '/files/upload'\n    },\n    uploadHeaders () {\n      return {\n        Authorization: `Bearer ${this.authToken}`\n      }\n    }\n  },\n  methods: {\n    handleUploaded (response) {\n      if (!response.success) {\n        this.$message.error(response.error)\n      }\n\n      this.url = this.newUrl = response.url\n    },\n    async submit () {\n      await this.$http\n        .patch(`users/${this.$parent.currentUser.username}`, {\n          avatar: this.newUrl\n        })\n        .then(() => {\n          this.$message.success('头像已更新')\n          this.$store.dispatch('loadUser')\n        })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/modules/users/profile"}]}