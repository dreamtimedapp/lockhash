{"remainingRequest":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js!/root/lockhash/web-app/node_modules/babel-loader/lib/index.js!/root/lockhash/web-app/node_modules/eslint-loader/index.js??ref--13-0!/root/lockhash/web-app/src/router/beforeEach.js","dependencies":[{"path":"/root/lockhash/web-app/src/router/beforeEach.js","mtime":1553930101455},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import vuex from '../vuex';\n\nvar needAuth = function needAuth(route) {\n  return route.meta.requiresAuth === true;\n};\n\nvar beforeEach = function beforeEach(to, from, next) {\n  /**\n   * Otherwise  if authentication is required login.\n   */\n  vuex.dispatch('checkUserToken').then(function () {\n    if (vuex.getters.isLogged && to.path.indexOf('auth') > 0) {\n      return next({\n        name: 'home'\n      });\n    }\n\n    return next();\n  }).catch(function () {\n    if (needAuth(to)) {\n      // No token, or it is invalid\n      return next({\n        name: 'auth.login'\n      }); // redirect to login\n    }\n\n    next();\n  });\n};\n\nexport default beforeEach;",{"version":3,"sources":["/root/lockhash/web-app/src/router/beforeEach.js"],"names":["vuex","needAuth","route","meta","requiresAuth","beforeEach","to","from","next","dispatch","then","getters","isLogged","path","indexOf","name","catch"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,SAAjB;;AAEA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAC,KAAK;AAAA,SAAIA,KAAK,CAACC,IAAN,CAAWC,YAAX,KAA4B,IAAhC;AAAA,CAAtB;;AAEA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAoB;AACrC;;;AAGAR,EAAAA,IAAI,CACDS,QADH,CACY,gBADZ,EAEGC,IAFH,CAEQ,YAAM;AACV,QAAIV,IAAI,CAACW,OAAL,CAAaC,QAAb,IAAyBN,EAAE,CAACO,IAAH,CAAQC,OAAR,CAAgB,MAAhB,IAA0B,CAAvD,EAA0D;AACxD,aAAON,IAAI,CAAC;AAAEO,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAX;AACD;;AACD,WAAOP,IAAI,EAAX;AACD,GAPH,EAQGQ,KARH,CAQS,YAAM;AACX,QAAIf,QAAQ,CAACK,EAAD,CAAZ,EAAkB;AAChB;AACA,aAAOE,IAAI,CAAC;AAAEO,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAX,CAFgB,CAEoB;AACrC;;AACDP,IAAAA,IAAI;AACL,GAdH;AAeD,CAnBD;;AAqBA,eAAeH,UAAf","sourcesContent":["import vuex from '../vuex'\n\nconst needAuth = route => route.meta.requiresAuth === true\n\nconst beforeEach = (to, from, next) => {\n  /**\n   * Otherwise  if authentication is required login.\n   */\n  vuex\n    .dispatch('checkUserToken')\n    .then(() => {\n      if (vuex.getters.isLogged && to.path.indexOf('auth') > 0) {\n        return next({ name: 'home' })\n      }\n      return next()\n    })\n    .catch(() => {\n      if (needAuth(to)) {\n        // No token, or it is invalid\n        return next({ name: 'auth.login' }) // redirect to login\n      }\n      next()\n    })\n}\n\nexport default beforeEach\n"]}]}