{"remainingRequest":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js!/root/lockhash/web-app/node_modules/babel-loader/lib/index.js!/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/root/lockhash/web-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/lockhash/web-app/src/modules/users/tabs/activities.vue?vue&type=script&lang=js&","dependencies":[{"path":"/root/lockhash/web-app/src/modules/users/tabs/activities.vue","mtime":1553930101455},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/lockhash/web-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport UserCard from '$components/user-card';\nimport ArrowDownIcon from '$icons/ArrowDown';\nimport SourceCommitEnd from '$icons/SourceCommitEnd';\nimport EmptyState from '$components/empty-state';\nexport default {\n  name: 'user-activities',\n  data: function data() {\n    return {\n      activities: {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      }\n    };\n  },\n  components: {\n    UserCard: UserCard,\n    ArrowDownIcon: ArrowDownIcon,\n    SourceCommitEnd: SourceCommitEnd,\n    EmptyState: EmptyState\n  },\n  beforeRouteUpdate: function beforeRouteUpdate(to, from, next) {\n    if (to.params.username != from.params.username) {\n      this.activities = {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      };\n      this.loadActivities(to.params.username);\n    }\n\n    next();\n  },\n  methods: {\n    subjectLink: function subjectLink(activity) {\n      switch (activity.subject_type) {\n        case 'App\\\\Thread':\n          if (activity.log_name == 'commented.thread') {\n            return {\n              name: 'threads.show',\n              params: {\n                id: activity.subject.id\n              },\n              hash: '#comment-' + activity.properties.comment_id || 0\n            };\n          }\n\n          return {\n            name: 'threads.show',\n            params: {\n              id: activity.subject.id\n            }\n          };\n\n        case 'App\\\\Comment':\n          return {\n            name: 'threads.show',\n            params: {\n              id: activity.subject.id\n            }\n          };\n\n        case \"App\\\\User\":\n          return {\n            name: 'users.show',\n            params: {\n              id: activity.subject.username\n            }\n          };\n      }\n\n      return {};\n    },\n    loadActivities: function loadActivities(username) {\n      var _this = this;\n\n      var page = this.activities.meta.current_page + 1;\n      this.$http.get(\"user/\".concat(username, \"/activities?per_page=10&page=\").concat(page)).then(function (activities) {\n        _this.activities.data = _this.activities.data.concat(activities.data);\n        _this.activities.meta = activities.meta;\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.loadActivities(this.$parent.user.username);\n  }\n};",{"version":3,"sources":["activities.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA,OAAA,QAAA,MAAA,uBAAA;AACA,OAAA,aAAA,MAAA,kBAAA;AACA,OAAA,eAAA,MAAA,wBAAA;AACA,OAAA,UAAA,MAAA,yBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,iBADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,UAAA,EAAA;AACA,QAAA,IAAA,EAAA,EADA;AAEA,QAAA,IAAA,EAAA;AACA,UAAA,YAAA,EAAA,CADA;AAEA,UAAA,SAAA,EAAA;AAFA;AAFA;AADA,KAAA;AASA,GAZA;AAaA,EAAA,UAAA,EAAA;AAAA,IAAA,QAAA,EAAA,QAAA;AAAA,IAAA,aAAA,EAAA,aAAA;AAAA,IAAA,eAAA,EAAA,eAAA;AAAA,IAAA,UAAA,EAAA;AAAA,GAbA;AAcA,EAAA,iBAdA,6BAcA,EAdA,EAcA,IAdA,EAcA,IAdA,EAcA;AACA,QAAA,EAAA,CAAA,MAAA,CAAA,QAAA,IAAA,IAAA,CAAA,MAAA,CAAA,QAAA,EAAA;AACA,WAAA,UAAA,GAAA;AACA,QAAA,IAAA,EAAA,EADA;AAEA,QAAA,IAAA,EAAA;AACA,UAAA,YAAA,EAAA,CADA;AAEA,UAAA,SAAA,EAAA;AAFA;AAFA,OAAA;AAOA,WAAA,cAAA,CAAA,EAAA,CAAA,MAAA,CAAA,QAAA;AACA;;AAEA,IAAA,IAAA;AACA,GA3BA;AA4BA,EAAA,OAAA,EAAA;AACA,IAAA,WADA,uBACA,QADA,EACA;AACA,cAAA,QAAA,CAAA,YAAA;AACA,aAAA,aAAA;AACA,cAAA,QAAA,CAAA,QAAA,IAAA,kBAAA,EAAA;AACA,mBAAA;AACA,cAAA,IAAA,EAAA,cADA;AAEA,cAAA,MAAA,EAAA;AAAA,gBAAA,EAAA,EAAA,QAAA,CAAA,OAAA,CAAA;AAAA,eAFA;AAGA,cAAA,IAAA,EAAA,cAAA,QAAA,CAAA,UAAA,CAAA,UAAA,IAAA;AAHA,aAAA;AAKA;;AACA,iBAAA;AAAA,YAAA,IAAA,EAAA,cAAA;AAAA,YAAA,MAAA,EAAA;AAAA,cAAA,EAAA,EAAA,QAAA,CAAA,OAAA,CAAA;AAAA;AAAA,WAAA;;AACA,aAAA,cAAA;AACA,iBAAA;AAAA,YAAA,IAAA,EAAA,cAAA;AAAA,YAAA,MAAA,EAAA;AAAA,cAAA,EAAA,EAAA,QAAA,CAAA,OAAA,CAAA;AAAA;AAAA,WAAA;;AACA,aAAA,WAAA;AACA,iBAAA;AACA,YAAA,IAAA,EAAA,YADA;AAEA,YAAA,MAAA,EAAA;AAAA,cAAA,EAAA,EAAA,QAAA,CAAA,OAAA,CAAA;AAAA;AAFA,WAAA;AAbA;;AAkBA,aAAA,EAAA;AACA,KArBA;AAsBA,IAAA,cAtBA,0BAsBA,QAtBA,EAsBA;AAAA;;AACA,UAAA,IAAA,GAAA,KAAA,UAAA,CAAA,IAAA,CAAA,YAAA,GAAA,CAAA;AACA,WAAA,KAAA,CACA,GADA,gBACA,QADA,0CACA,IADA,GAEA,IAFA,CAEA,UAAA,UAAA,EAAA;AACA,QAAA,KAAA,CAAA,UAAA,CAAA,IAAA,GAAA,KAAA,CAAA,UAAA,CAAA,IAAA,CAAA,MAAA,CAAA,UAAA,CAAA,IAAA,CAAA;AACA,QAAA,KAAA,CAAA,UAAA,CAAA,IAAA,GAAA,UAAA,CAAA,IAAA;AACA,OALA;AAMA;AA9BA,GA5BA;AA4DA,EAAA,OA5DA,qBA4DA;AACA,SAAA,cAAA,CAAA,KAAA,OAAA,CAAA,IAAA,CAAA,QAAA;AACA;AA9DA,CAAA","sourcesContent":["<template>\n  <div class=\"user-activities\">\n    <div v-if=\"activities.data.length <= 0\">\n      <empty-state />\n    </div>\n    <ul class=\"timeline pb-2\" v-else>\n      <li class=\"timeline-item\" v-for=\"activity in activities.data\" :key=\"activity.id\" v-if=\"activity.subject\">\n        <div class=\"timeline-heading\">\n          <div class=\"d-flex\">\n            <router-link :to=\"{name:'users.show', params: {username: $parent.user.username}}\">\n              <img :src=\"$parent.user.avatar\" class=\"avatar-40\" :alt=\"$parent.user.name\" />\n            </router-link>\n            <div class=\"ml-2\">\n              <div>\n                <router-link :to=\"{name:'users.show', params: {username: $parent.user.username}}\">\n                  <h6 class=\"mb-0 text-16 d-inline-block\">{{ $parent.user.name }}</h6>\n                </router-link>\n                <span class=\"text-gray-60 ml-1\">\n                  <template v-if=\"activity.log_name == 'commented.thread'\">\n                    评论了 <router-link :to=\"subjectLink(activity)\">《{{ activity.subject.title }}》</router-link>\n                  </template>\n                  <template v-else-if=\"activity.log_name == 'published.thread'\">\n                    发布了 <router-link :to=\"subjectLink(activity)\">《{{ activity.subject.title }}》</router-link>\n                  </template>\n                  <template v-else-if=\"activity.log_name == 'like.thread'\">\n                    赞了 <router-link :to=\"subjectLink(activity)\">《{{ activity.subject.title }}》</router-link>\n                  </template>\n                  <template v-else-if=\"activity.log_name == 'follow.user'\">\n                    关注了 <router-link :to=\"subjectLink(activity)\">{{ activity.subject.username }}</router-link>\n                  </template>\n                </span>\n              </div>\n              <div class=\"text-12 text-gray-70\"><small class=\"text-muted\">{{ activity.created_at_timeago }}</small></div>\n            </div>\n          </div>\n        </div>\n        <div class=\"timeline-body\">\n          <user-card :user=\"activity.subject\" v-if=\"activity.log_name == 'follow.user'\"></user-card>\n          <div class=\"box cursor-pointer\" v-else>\n            <router-link class=\"text-muted\" :to=\"subjectLink(activity)\">{{ activity.properties['content'] || '无' }}</router-link>\n          </div>\n        </div>\n      </li>\n      <li class=\"timeline-item\" v-if=\"activities.meta.current_page < activities.meta.last_page\">\n        <div class=\"timeline-heading\">\n          <div class=\"d-flex\">\n            <button class=\"btn btn-secondary btn-icon text-20\" @click=\"loadActivities($parent.user.username)\">\n              <arrow-down-icon /></button>\n          </div>\n        </div>\n      </li>\n      <li class=\"timeline-item\" v-if=\"activities.meta.current_page == activities.meta.last_page\">\n        <div class=\"timeline-heading\">\n          <div class=\"d-flex\">\n            <button class=\"btn btn-secondary btn-icon text-20\" disabled>\n              <source-commit-end /></button>\n          </div>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport UserCard from '$components/user-card'\nimport ArrowDownIcon from '$icons/ArrowDown'\nimport SourceCommitEnd from '$icons/SourceCommitEnd'\nimport EmptyState from '$components/empty-state'\n\nexport default {\n  name: 'user-activities',\n  data () {\n    return {\n      activities: {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      }\n    }\n  },\n  components: { UserCard, ArrowDownIcon, SourceCommitEnd, EmptyState },\n  beforeRouteUpdate (to, from, next) {\n    if (to.params.username != from.params.username) {\n      this.activities = {\n        data: [],\n        meta: {\n          current_page: 0,\n          last_page: 0\n        }\n      }\n      this.loadActivities(to.params.username)\n    }\n\n    next()\n  },\n  methods: {\n    subjectLink (activity) {\n      switch (activity.subject_type) {\n      case 'App\\\\Thread':\n        if (activity.log_name == 'commented.thread') {\n          return {\n            name: 'threads.show',\n            params: { id: activity.subject.id },\n            hash: '#comment-' + activity.properties.comment_id || 0\n          }\n        }\n        return { name: 'threads.show', params: { id: activity.subject.id } }\n      case 'App\\\\Comment':\n        return { name: 'threads.show', params: { id: activity.subject.id } }\n      case 'App\\\\User':\n        return {\n          name: 'users.show',\n          params: { id: activity.subject.username }\n        }\n      }\n      return {}\n    },\n    loadActivities (username) {\n      let page = this.activities.meta.current_page + 1\n      this.$http\n        .get(`user/${username}/activities?per_page=10&page=${page}`)\n        .then(activities => {\n          this.activities.data = this.activities.data.concat(activities.data)\n          this.activities.meta = activities.meta\n        })\n    }\n  },\n  mounted () {\n    this.loadActivities(this.$parent.user.username)\n  }\n}\n</script>\n"],"sourceRoot":"src/modules/users/tabs"}]}